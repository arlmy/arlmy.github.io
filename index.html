<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HOME</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.0.0/marked.min.js"></script>
  <link rel="stylesheet" href="/index.css" />
  <style>
    .editor-container {
      display: flex;
      gap: 20px;
      margin: 20px;
    }
    #markdown-input, #html-preview {
      flex: 1;
      min-height: 300px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    #html-preview {
      overflow: auto;
    }
  </style>
</head>

<body>
  <div id="html-preview"></div>

  <button id="toggle-editor" style="margin: 20px; padding: 8px 16px;">O</button>
  
  <div id="editor-container" style="display: none; margin: 20px;">
    <textarea id="markdown-input" style="width: 100%; min-height: 200px; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
[ [home] ](/index.html)

- [Tools](/Tools.html)
- [Learning Projects](/LearningProjects.html)
- [Worth To Watch](/WorthToWatch.html)
- [About](/About.html)

    </textarea>
  </div>

  <script>
    const input = document.getElementById('markdown-input');
    const preview = document.getElementById('html-preview');
    const toggleBtn = document.getElementById('toggle-editor');
    const editorContainer = document.getElementById('editor-container');
    let hasUnsavedChanges = false;
    let saveTimer = null;
    
    // 从本地存储加载内容
    const savedContent = localStorage.getItem('markdownContent');
    if (savedContent) {
      input.value = savedContent;
    }
    
    function updatePreview() {
      preview.innerHTML = marked.parse(input.value);
      hljs.highlightAll();
      hasUnsavedChanges = true;
      
      // 自动保存，延迟500ms避免频繁操作
      clearTimeout(saveTimer);
      saveTimer = setTimeout(() => {
        localStorage.setItem('markdownContent', input.value);
        hasUnsavedChanges = false;
      }, 500);
    }
    
    // 页面关闭前提示未保存的修改
    window.addEventListener('beforeunload', (e) => {
      if (hasUnsavedChanges) {
        e.preventDefault();
        e.returnValue = '您有未保存的修改，确定要离开吗？';
      }
    });

    input.addEventListener('input', updatePreview);
    updatePreview();

    toggleBtn.addEventListener('click', () => {
      const isHidden = editorContainer.style.display === 'none';
      editorContainer.style.display = isHidden ? 'block' : 'none';
      toggleBtn.textContent = isHidden ? 'X' : 'O';
    });
  </script>

<!-- 注释掉的评论功能
  <div id="tcomment"></div>
  <script src="https://unpkg.com/twikoo/dist/twikoo.all.min.js"></script>
  <script>
    twikoo.init({
      envId: 'https://comments.arlmy.me/.netlify/functions/twikoo',
      el: '#tcomment'
    })
  </script>
  -->

</body>
</html>


